---
type: mechanic
system: backend_architecture
tags: [async, optimization, double_buffering]
related_files:
  - "01_World_Lifecycle"
---

# Асинхронная Архитектура Мира

## 1. Двойная Буферизация (Double Buffering)
На сервере существуют два мира:
* **Мир А (Активный):** Где находятся игроки.
* **Мир Б (Теневой):** Где идет фоновая генерация следующей фазы.
При смене фазы происходит мгновенный телепорт (Swap).

## 2. Фоновая Генерация
1.  **Heavy Math (Thread):** Расчет лабиринта, навигации и лута происходит в отдельном потоке (`Task.Run`). Результат — чистые данные (`WorldData`).
2.  **Time-Slicing (Main Thread):** Воплощение объектов (Instantiate) происходит порциями (по 2мс на кадр), чтобы не просадить FPS сервера.

## 3. Развивающиеся Биомы
Используются клеточные автоматы (Cellular Automata) на виртуальной сетке.
* *Пример:* Если заражение клетки > 0.5, на стене включается объект "слизь". Это дешево, так как меняются свойства, а не геометрия.