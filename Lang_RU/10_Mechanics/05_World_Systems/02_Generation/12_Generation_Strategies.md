---
type: tech_spec
system: proc_gen
tags: [wfc, algorithms, strategy_pattern]
---

# Стратегии Генерации Города

## 1. Гибридный Подход (Skeleton & Meat)
Для PvPvE шутера используется двухэтапная генерация:
1.  **Скелет (Splines/Graph):** Сначала прокладываются агенты-дороги (L-Systems или Voronoi), создавая "кривые" улицы и неправильные формы кварталов.
2.  **Мясо (WFC):** Пустоты между улицами заполняются зданиями, которые адаптируются под границы дорог.

## 2. Макро-Планирование (Zoning)
Перед расстановкой стен карта размечается на зоны через **Диаграмму Вороного**:
* *Zone A:* Industrial (Завод).
* *Zone B:* Old Town (Жилой сектор).
* *Zone C:* No Man's Land (Буфер).

## 3. Паттерн "Стратегия"
Каждая зона использует свой алгоритм застройки через интерфейс `IDistrictGenerator`:
* **Industrial:** Использует `GridGenerator` (Прямые углы, широкие проспекты, крупные ангары).
* **Old Town:** Использует `OrganicGenerator` (Кривые сплайны, плотная застройка, тупики).

## 4. Вложенная Генерация (Nested WFC)
Крупные объекты (POI), такие как "Завод", являются "Черными ящиками".
1.  Глобальный генератор резервирует место (например, 200x200м).
2.  Внутри этого квадрата запускается **локальный WFC** с отдельным тайлсетом (трубы, цеха), который ограничен стенами по периметру.