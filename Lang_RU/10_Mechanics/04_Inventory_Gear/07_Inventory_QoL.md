---
type: mechanic
system: inventory
tags:
  - qol
  - ui
  - automation
  - controls
---

# Система: Автоматизация и Удобство (QoL)

## 1. Алгоритм "Умный Лут" (Smart Loot Algorithm)
Вместо ручного перетаскивания каждого предмета, игра использует алгоритм поиска свободного места.

### Механика действия "Подобрать" (Quick Loot)
При нажатии `Ctrl + Click` (из контейнера) или `E` (с земли):
1.  **Сканирование:** Система сканирует сетку инвентаря сверху-вниз, слева-направо.
2.  **Проверка Формы:** Если предмет имеет сложную форму (напр., `L`-образную) и не влезает в текущей ориентации, алгоритм виртуально вращает его на 90/180/270 градусов.
3.  **Размещение:** Если после вращения предмет входит в свободную полость ("дырку"), он автоматически поворачивается и помещается туда.
4.  **Отказ:** Если места нет ни в одной ориентации — воспроизводится звук "Инвентарь полон", предмет остается на месте.

> **Цель:** Игрок не должен думать "влезет ли бумеранг, если я его поверну?". Если дырка есть — игра сама вставит туда предмет.

## 2. Дефрагментация (Auto-Sort)
Кнопка в интерфейсе схрона или рюкзака.

* **Функция:** Полная реорганизация содержимого контейнера.
* **Логика:**
    1.  **Стэкинг:** Все неполные пачки (патроны, валюта) объединяются.
    2.  **Приоритет:** Большие предметы сдвигаются в верхнюю левую часть.
    3.  **Уплотнение:** Мелкие предметы заполняют оставшиеся пустоты между крупными.
    4.  **Вращение:** Система вращает предметы так, чтобы минимизировать количество пустых ячеек (Gap Minimization).

## 3. Цикл Расходников (Consumption Waste)
Использование предмета не всегда заставляет его исчезнуть бесследно. Это создает вторичную экономику "тары".

### Логика Мусора (Waste Logic)
Когда расходник (вода, батарея, стимулятор) используется:
1.  **Эффект:** Применяется к персонажу.
2.  **Генерация:** Исходный предмет заменяется на "Пустой" аналог (Empty Flask, Drained Battery).
3.  **Размещение:**
    * *Есть место:* Пустая тара падает обратно в тот же слот (или соседний).
    * *Нет места:* Персонаж автоматически выбрасывает мусор на землю (Drop).

### Типы Отходов
| Исходник | Отход | Применение Отхода |
| :--- | :--- | :--- |
| **Батарея (Battery Charge)** | **Разряженная Батарея** | Можно зарядить в Хабе за дешево (или от генератора). Можно продать Технократам. |
| **Бутылка Воды** | **Пустая Бутылка** | Можно набрать воду в источнике (бесплатно, но грязно) или в Кулере (чисто). |
| **Стимулятор (Inject)** | **Использованный Шприц** | Мусор (Scrap). Можно переработать в пластик/стекло на верстаке. |
| **Консервы** | **Жестяная банка** | Мусор. Используется для создания ловушек-шумелок. |

## 4. Экстренный Сброс (Panic Drop)
Механика для мгновенного управления перегрузом в критической ситуации.

* **Хоткей:** `Z` (Двойное нажатие).
* **Действие:** Персонаж мгновенно сбрасывает на землю **Рюкзак** со всем содержимым.
* **Причина:** Рюкзак часто содержит основной вес лута. Сброс позволяет мгновенно вернуть мобильность (снять штрафы к Стамине и Скорости) для вступления в бой.
* **После боя:** Рюкзак можно подобрать обратно (`E`), если выживете.

## 5. Контроль и Безопасность (Input & Safety)

### Логика Клавиши Инвентаря (Tab Interaction)
Разделение на быстрый доступ и глубокий менеджмент для сохранения динамики.

1.  **Быстрый Осмотр (Hold):**
    * *Действие:* Удержание клавиши.
    * *UI:* Появляется легкий(60% прозрачности)) HUD (Патроны, HP, слоты Разгрузки, Сетка рюкзака).
    * *Управление:* Курсор не активен. Персонаж сохраняет подвижность и управление камерой.
2.  **Режим Рюкзака (Toggle):**
    * *Действие:* Одиночное нажатие.
    * *UI:* Полное открытие сетки инвентаря(30% прозрачности).
    * *Управление:* Включается курсор мыши. Вращение камеры блокируется.

### Рефлекс Выживания (Combat Auto-Close)
Механика, имитирующая шок от ранения.
* **Триггер:** Получение любого урона по здоровью (HP Damage) > 5 ед.
* **Реакция:** Интерфейс инвентаря мгновенно принудительно закрывается.
* **Цель:** Вернуть игрока в боевой режим. Игрок не должен искать кнопку "Выход", когда его убивают — он должен сразу видеть врага.