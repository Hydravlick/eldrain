---
type: mechanic
system: currency
tags: [rez, wallet, inventory, sync]
related_files:
  - "[[Lang_RU/10_Mechanics/03_Economy_Resources/01_Currency_Rez|Currency_Rez]]"
  - "[[Lang_RU/10_Mechanics/04_Inventory_Gear/02_Containers_Slots|Containers_Slots]]"
---

# Валюта: Менеджер Синхронизации (Currency Sync)

## 1. Природа Валюты
В Элдрейне **нет абстрактного счета**. Вся валюта (`Rez`, `Scrips`) — это физические предметы (`Item`), занимающие слоты в Инвентаре или Схроне (Stash).

## 2. Виртуальный Кошелек (Unified Wallet UI)
Для удобства игрока (HUD) и торговли, система агрегирует данные, показывая общую сумму.

### Формула Отображения
$$UI\_Balance = Inventory.Count(Rez\_ID) + Stash.Count(Rez\_ID)$$

* **Inventory Source:** Валюта в карманах/рюкзаке. Доступна в рейде и Хабе.
* **Stash Source:** Валюта в банке. Доступна *только* в Хабе (у торговцев/верстака).

## 3. Логика Транзакции (Spending Logic)
Когда игрок что-то покупает или крафтит, система списывает предметы в приоритетном порядке:

1.  **Check:** Проверка `Total_Balance >= Cost`.
2.  **Step 1 (Inventory):** Пытаемся списать из инвентаря.
    * *Если хватает:* Удаляем нужное кол-во предметов.
    * *Если не хватает:* Удаляем всё из инвентаря, запоминаем остаток долга (`Remainder`).
3.  **Step 2 (Stash):** Если есть `Remainder`, списываем остаток из Схрона.
    * *Важно:* Если игрок находится **в Рейде**, списание из Схрона **ЗАПРЕЩЕНО**.

## 4. Дроп при Смерти
Так как валюта — это предмет:
* Валюта в **Инвентаре** выпадает (если не в Подсумке).
* Валюта в **Схроне** остается в безопасности.